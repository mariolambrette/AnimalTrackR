% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/classify_hmm_utils.R
\name{.classify_hmm}
\alias{.classify_hmm}
\title{INTERNAL Classify activity states using Hidden Markov Models}
\usage{
.classify_hmm(dets, features, n_states = 2, indiv_id = NULL, video_id = NULL)
}
\arguments{
\item{dets}{Data frame containing detection data with feature columns}

\item{features}{Character vector of feature column names to use in HMM}

\item{n_states}{Integer. Number of hidden states to fit (default 2)}

\item{indiv_id}{Character. Column name for individual ID. If provided, fits
separate HMMs per individual (recommended). Default NULL fits single HMM
to all data.}

\item{video_id}{Character. Column name for video/temporal ID used to handle
temporal breaks within individuals. Default NULL.}
}
\value{
Data frame identical to \code{dets} with two columns added:
\itemize{
\item \code{state}: Integer state assignment (1 to n_states)
\item \code{state_prob}: Probability of the assigned state
}
Returns NA for rows with incomplete feature data or if fitting fails.
}
\description{
Main internal HMM classification function. Fits HMMs to detection data with
automatic distribution selection for each feature. Supports per-individual
fitting (recommended for stability when dealing with multiple individuals)
and handles temporal breaks via video IDs.
}
\details{
The function performs the following steps:
\enumerate{
\item Validates that all required features exist in the data
\item If \code{indiv_id} provided, fits separate HMMs per individual
\item Calls \code{.fit_individual_hmm} for each individual or dataset
\item Standardizes state labels so higher states = higher activity
}

Individuals with fewer than 10 observations are skipped with a warning.
}
\keyword{internal}
