% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/classify_activity.R
\name{classify_activity}
\alias{classify_activity}
\title{Classify activity states from AnimalTrackR detections}
\usage{
classify_activity(
  dets,
  method = "gmm",
  features = c("speed", "acceleration", "turning"),
  n_states = 2,
  window_size = 5,
  composite_method = "mean",
  feature_weights = NULL,
  indiv_id = NULL,
  cpt_method = "mean",
  pause_threshold = NULL,
  video_id = "Video"
)
}
\arguments{
\item{dets}{Dataframe of AnimalTrackR detections with at least the following
columns: \itemize{
\item \code{vid_id}
\item \code{Frame}
\item \code{xc}
\item \code{yc}
}
If detections are present for multiple individuals, an additional column
specifying individual ID can be provided via the \code{indiv_id} parameter.
Any other columns in the dataframe will be ignored and retained in the
output.}

\item{method}{Classification method to use. Options are: \itemize{
\item \code{"gmm"}: Gaussian Mixture Model (default)
\item \code{"threshold"}: Otsu thresholding on composite activity score
\item \code{"changepoint"}: Change point detection on composite activity
score
\item \code{"hmm"}: Hidden Markov Model on raw features
}}

\item{features}{Character vector of movement features to use for
classification. Options include: \itemize{
\item \code{"speed"} - Instantaneous speed (pixels per frame)
\item \code{"acceleration"} - Change in speed between frames
\item \code{"turning"} - Absolute turning angle (radians)
\item \code{"speed_var"} - Variance in speed over rolling window
\item \code{"speed_smooth"} - Speed smoothed over rolling window
\item \code{"meander"} - Path tortuosity measure
\item \code{"path_straightness"} - Net displacement to path length ratio
\item \code{"paused"} - Binary indicator of paused state
\item \code{"time_since_pause"} - Frames since last pause
\item \code{"spatial_spread"} - Space use variance in rolling window
\item \code{"edge_preference"} - Proximity to arena edges
\item \code{"roaming_entropy"} - Spatial entropy based on grid occupancy
}
Default features are \code{c("speed", "acceleration", "turning")}. A more
detailed description of each feature can be found in
\code{vignette("classify-activity")}.}

\item{n_states}{Integer. Number of activity states to classify. Default is 2
(active/inactive).}

\item{window_size}{Integer. Rolling window size for smoothed features. The
window will be \code{window_size} rows wide in the \code{dets} dataframe, so
users should consider the framerate of their data when selecting this
parameter. Default is 5.}

\item{composite_method}{Method to combine multiple features into a single
composite activity score. Options are: \itemize{
\item \code{"mean"}: Mean of selected features (default)
\item \code{"pca"}: First principal component of selected features
\item \code{"weighted"}: Weighted mean of selected features (requires
\code{feature_weights} parameter)
}}

\item{feature_weights}{Named numeric vector of feature weights to use when
\code{composite_method = "weighted"}. If \code{NULL}, equal weights are used.
The length and names of the vector must match the \code{features} parameter.
Weights are normalised to sum to 1 internally if they do not already.}

\item{indiv_id}{Character. Optional column name in \code{dets} specifying
individual ID. If \code{NULL}, all detections are assumed to be from a single
individual. For HMM, separate models are fitted per individual.}

\item{cpt_method}{Change point detection method to use when
\code{method = "changepoint"}.
Options are: \itemize{
\item \code{"mean"}: Identify changepoints in the mean of the composite
activity score
\item \code{"var"}: Identify changepoints in the variance of the composite
activity score
\item \code{"meanvar"}: Identify changepoints in both the mean and variance
of the composite activity score
}
Default is \code{"mean"}.}

\item{pause_threshold}{Numeric. Speed threshold (in pixels per frame) below
which the animal is considered to be paused/stationary. Required if using
pause-based features (\code{"paused"} or \code{"time_since_pause"}).
Default is \code{NULL}.}

\item{video_id}{Character. Column name in \code{dets} that identifies
different videos. Default is \code{"vid_id"}. Change this only if your
detection data uses a different column name for video identification (e.g.,
\code{"video_name"} or \code{"recording_id"}).}
}
\value{
A dataframe identical to \code{dets} with the following columns
added:
\itemize{
\item \code{state}: Integer state assignment (1 = inactive, 2 = active when
\code{n_states = 2})
\item Feature columns as calculated (e.g., \code{speed},
\code{acceleration})
\item \code{composite_score}: Composite activity metric (for GMM,
threshold, and changepoint methods only)
\item Normalized feature columns prefixed with \code{norm_} (for non-HMM
methods)
}
}
\description{
This function takes AnimalTrackR detections and classifies them into
behavioural states. The default behaviour is to use a Gaussian Mixture Model
(GMM) to classify activity based on speed, acceleration and turning features,
into two states (active/inactive). Other classification methods and features
are also supported. Users are encouraged to explore the various options to
find the best approach for their data. A detailed description of the
function and its parameters can be found in the vignette:
\code{vignette("classify-activity")}. It is recommended to read through the
vignette to understand the various options and their implications before
using this function.
}
\section{Dependencies}{

Different classification methods require different packages:
\itemize{
\item \strong{gmm}: Requires \code{mclust}
\item \strong{threshold}: No additional dependencies
\item \strong{changepoint}: Requires \code{changepoint}
\item \strong{hmm}: Requires \code{hmmTMB}, \code{fitdistrplus}, and
\code{CircStats}
}
Install optional dependencies with:
\code{install.packages(c("changepoint", "hmmTMB", "fitdistrplus",
"CircStats", "mclust"))}
}

\examples{
\dontrun{
# Load example detection data
dets <- read.csv("path/to/detections.csv")

# Basic GMM classification with default features
result <- classify_activity(dets)

# HMM classification with custom features
result <- classify_activity(
  dets,
  method = "hmm",
  features = c("speed", "turning", "spatial_spread"),
  indiv_id = "fish_id"
)

# Threshold classification with weighted composite
result <- classify_activity(
  dets,
  method = "threshold",
  features = c("speed", "acceleration", "turning"),
  composite_method = "weighted",
  feature_weights = c(speed = 2, acceleration = 1, turning = 1)
)

# Changepoint detection with custom window
result <- classify_activity(
  dets,
  method = "changepoint",
  features = c("speed_smooth", "path_straightness"),
  window_size = 30,
  cpt_method = "meanvar"
)
}

}
\seealso{
\code{\link{calculate_movement_features}},
\code{\link{behaviour_viz}}, \code{vignette("classify-activity")}
}
